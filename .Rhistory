njlong <- njlong %>%
mutate(survey = case_when(
survey == "October19" | survey == "January20" ~ "November19",
TRUE ~ as.factor(survey)))
suscep1 <- njlong %>% subset(scientific_name == "Meandrina meandrites" |
scientific_name == "Eusmilia fastigiata" |
scientific_name == "Dichocoenia stokesii" |
scientific_name == "Dendrogyra cylindrus") %>%
group_by(location_name, time_point, survey, scientific_name) %>%
summarize(N_site = sum(count_adult), density = (sum(count_adult))/30)
susmeans1 <- suscep1 %>% group_by(survey, scientific_name) %>%
summarize(MeanDens = mean(density), seDens = se(density), maxDens = max(density), N = sum(N_site)) %>%
unite("GroupEvent", c(scientific_name,survey))
suscep1 <- suscep1 %>% unite("GroupEvent", c(scientific_name, survey), remove = FALSE) %>%
left_join(susmeans1, by = "GroupEvent") %>%
mutate_at(.vars = vars("time_point"),
.funs = funs(factor(.,levels = TimeLevels, ordered = TRUE)))
library(MASS)
library(detectseparation)
#family level df
levels(as.factor(njlong$scientific_name))
efas <- demo %>% subset(scientific_name == "Eusmilia fastigiata")
njlong$scientific_name <- recode(njlong$scientific_name,
"Porites porities" = "Porites porites")
njfam <- njlong %>% mutate("Family" = case_when(
scientific_name == "Agaricia spp."|scientific_name == "Agaricia agaricites"|
scientific_name == "Agaricia tenuifolia"|scientific_name == "Agaricia lamarckiana"|
scientific_name == "Helioseris cucullata" ~ "Agariciidae",
scientific_name == "Pseudodiploria strigosa"|scientific_name == "Orbicella faveolata"|
scientific_name == "Montastraea cavernosa"|scientific_name == "Diploria labyrinthiformis"|
scientific_name == "Orbicella spp."|scientific_name == "Orbicella annularis"|
scientific_name == "Orbicella franksi"|scientific_name == "Favia fragum"|
scientific_name == "Colpophyllia natans"|scientific_name == "Pseudodiploria clivosa" ~ "Faviidae",
scientific_name == "Porites porites"|scientific_name == "Porites astreoides" ~ "Poritidae",
scientific_name == "Stephanocoenia intersepta" ~ "Astrocoeniidae",
scientific_name == "Eusmilia fastigiata"|scientific_name == "Dendrogyra cylindrus"|
scientific_name == "Meandrina meandrites"|scientific_name == "Dichocoenia stokesii" ~ "Meandrinidae",
scientific_name == "Siderastrea radians"|scientific_name == "Siderastrea siderea" ~ "Siderastreidae",
scientific_name == "Mycetophyllia aliciae"|scientific_name == "Isophyllia rigida"|
scientific_name == "Mycetophyllia spp."|scientific_name == "Scolymia cubensis"|
scientific_name == "Isophyllia sinuosa" ~ "Mussidae",
scientific_name == "Madracis decactis" ~ "Pocilloporidae",
scientific_name == "Acropora cervicornis" ~ "Acroporidae"))
njfam$count_adult[is.na(njfam$count_adult)] <- 0
mea <- njfam %>% subset(Family == "Meandrinidae")
famdens <- njfam %>%
group_by(location_name, survey, event, time_point, Family) %>%
summarize(count_adult = sum(count_adult)) %>%
mutate(count = count_adult+1, dens = count_adult/30)
hist(famdens$count)
############################
#species specific densities
dens <- njlong %>% rename("Species" = scientific_name)
dens$count_adult[is.na(dens$count_adult)] <- 0
denssum <- dens %>% group_by(Species) %>% summarize(total = sum(count_adult)) %>%
arrange(total)
dens <- dens %>% right_join(denssum, by = "Species") %>% subset(Species != "Agaricia spp.") %>% droplevels()
dens <- dens %>% subset(total > 7) %>% mutate_at(.vars = vars("time_point"),
.funs = funs(factor(.,levels = TimeLevels, ordered = TRUE)))
hist(dens$count_adult)
densmod <- glmer(count_adult ~ survey*Species + (1|location_name), family = "poisson",
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)),
data = dens)
zinbinom1 <- glmmTMB(count_adult ~ (1|location_name) + survey*Species,
data = dens,
ziformula = ~1,
family = nbinom1)
hist(resid(zinbinom1))
hurdlemod <- mixed_model(fixed = count_adult ~ survey * Species, random = ~1 | location_name,
data = dens, family = zi.negative.binomial(),
zi_fixed = ~ Species, zi_random = NULL,
max_coef_value = 30,
control = list(iter_EM = 0))
library(GLMMadaptive)
hurdlemod <- mixed_model(fixed = count_adult ~ survey * Species, random = ~1 | location_name,
data = dens, family = zi.negative.binomial(),
zi_fixed = ~ Species, zi_random = NULL,
max_coef_value = 30,
control = list(iter_EM = 0))
hist(resid(hurdlemod))
AIC(hurdlemod)
AIC(zinbinom1)
emm <- emmeans(zinbinom1, ~ survey*Species)
simple <- pairs(emm, simple = "survey")
pairwise <- as.data.frame(pairs(emm, simple = "survey"))
df <- data.frame()
Spec <- levels(as.factor(pairwise$Species))
for(current_Spec in Spec) {
Spec_df <- pairwise %>% subset(Species == current_Spec)
pairwise$sig <- isSig(pairwise$p.value)
letters <- as.data.frame(cldList(p.value ~ contrast,
data = Spec_df,
threshold = 0.05)) %>%
mutate("Species" = current_Spec)
df <- df %>%
bind_rows(letters)
}
denslet <- df %>% unite("Event", c("Species", "Group"))
dens <- dens %>% unite("Event", c("Species", "survey"), remove = FALSE)
dens2 <- dens %>% left_join(denslet, by = "Event")
denssum <- dens2 %>% group_by(Event) %>%
summarize(max = max(count_adult), N = sum(count_adult))
dens3 <- dens2 %>% left_join(denssum, by = "Event")
high <- dens3 %>% subset(Species == "Agaricia agaricites" | Species == "Agaricia tenuifolia"|
Species == "Porites astreoides" | Species == "Porites porites")
highdensp <- ggplot() +
geom_jitter(data = high, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = high, aes(x = survey, y = max+10, label = Letter)) +
geom_violin(data = high, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = high, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,150), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
highdensp
med <- dens3 %>% subset(Species == "Orbicella spp." | Species == "Siderastrea radians"|
Species == "Siderastrea siderea")
meddensp <- ggplot() +
geom_jitter(data = med, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = med, aes(x = survey, y = max+10, label = Letter)) +
geom_violin(data = med, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = med, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,100), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
meddensp
meddensp <- ggplot() +
geom_jitter(data = med, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = med, aes(x = survey, y = max+10, label = Letter)) +
geom_boxplot(data = med, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = med, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,100), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
meddensp
low <- dens3 %>% subset(Species == "Diploria labyinthiformis" | Species == "Montastraea cavernosa"|
Species == "Pseudodiploria strigosa" | Species == "Stephanocoenia intersepta" |
Species == "Meandrina meandrites" | Species == "Eusmilia fastigiata" |
Species == "Dichocoenia stokesii")
lowdensp <- ggplot() +
geom_jitter(data = low, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = low, aes(x = survey, y = max+5, label = Letter)) +
geom_violin(data = low, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = low, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,20), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
lowdensp
lowdensp <- ggplot() +
geom_jitter(data = low, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = low, aes(x = survey, y = max+5, label = Letter)) +
geom_boxplot(data = low, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = low, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,20), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
lowdensp
emm <- emmeans(hurdlemod, ~ survey*Species)
simple <- pairs(emm, simple = "survey")
pairwise <- as.data.frame(pairs(emm, simple = "survey"))
df <- data.frame()
Spec <- levels(as.factor(pairwise$Species))
for(current_Spec in Spec) {
Spec_df <- pairwise %>% subset(Species == current_Spec)
pairwise$sig <- isSig(pairwise$p.value)
letters <- as.data.frame(cldList(p.value ~ contrast,
data = Spec_df,
threshold = 0.05)) %>%
mutate("Species" = current_Spec)
df <- df %>%
bind_rows(letters)
}
denslet <- df %>% unite("Event", c("Species", "Group"))
dens <- dens %>% unite("Event", c("Species", "survey"), remove = FALSE)
dens2 <- dens %>% left_join(denslet, by = "Event")
denssum <- dens2 %>% group_by(Event) %>%
summarize(max = max(count_adult), N = sum(count_adult))
dens3 <- dens2 %>% left_join(denssum, by = "Event")
high <- dens3 %>% subset(Species == "Agaricia agaricites" | Species == "Agaricia tenuifolia"|
Species == "Porites astreoides" | Species == "Porites porites")
highdensp <- ggplot() +
geom_jitter(data = high, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = high, aes(x = survey, y = max+10, label = Letter)) +
geom_violin(data = high, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = high, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,150), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
highdensp
highdensp <- ggplot() +
geom_jitter(data = high, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = high, aes(x = survey, y = max+10, label = Letter)) +
geom_boxplot(data = high, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = high, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,150), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
highdensp
med <- dens3 %>% subset(Species == "Orbicella spp." | Species == "Siderastrea radians"|
Species == "Siderastrea siderea")
meddensp <- ggplot() +
geom_jitter(data = med, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = med, aes(x = survey, y = max+10, label = Letter)) +
geom_boxplot(data = med, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = med, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,100), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
meddensp
low <- dens3 %>% subset(Species == "Diploria labyinthiformis" | Species == "Montastraea cavernosa"|
Species == "Pseudodiploria strigosa" | Species == "Stephanocoenia intersepta" |
Species == "Meandrina meandrites" | Species == "Eusmilia fastigiata" |
Species == "Dichocoenia stokesii")
lowdensp <- ggplot() +
geom_jitter(data = low, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = low, aes(x = survey, y = max+5, label = Letter)) +
geom_boxplot(data = low, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = low, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,20), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
lowdensp
lowdensp <- ggplot() +
geom_jitter(data = low, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = low, aes(x = survey, y = max+2, label = Letter)) +
geom_boxplot(data = low, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = low, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,20), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
lowdensp
highdensp <- ggplot() +
geom_jitter(data = high, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = high, aes(x = survey, y = max+10, label = Letter)) +
geom_boxplot(data = high, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = high, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,150), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
tiff("Figures/hurd_highdens.tif",width = 9, height = 4, units = "in", res = 400)
highdensp
dev.off()
med <- dens3 %>% subset(Species == "Orbicella spp." | Species == "Siderastrea radians"|
Species == "Siderastrea siderea")
meddensp <- ggplot() +
geom_jitter(data = med, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = med, aes(x = survey, y = max+10, label = Letter)) +
geom_boxplot(data = med, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = med, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,100), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
tiff("Figures/hurd_meddens.tif",width = 9, height = 4, units = "in", res = 400)
meddensp
dev.off()
low <- dens3 %>% subset(Species == "Diploria labyinthiformis" | Species == "Montastraea cavernosa"|
Species == "Pseudodiploria strigosa" | Species == "Stephanocoenia intersepta" |
Species == "Meandrina meandrites" | Species == "Eusmilia fastigiata" |
Species == "Dichocoenia stokesii")
lowdensp <- ggplot() +
geom_jitter(data = low, aes(x = time_point, y = count_adult, fill = location_name), size = 2, pch = 21,
width = 2,
height = 0, alpha = 0) +
geom_text(data = low, aes(x = survey, y = max+2, label = Letter)) +
geom_boxplot(data = low, aes(x = survey, y = count_adult), fill = "gray80", width = 7) +
geom_jitter(data = low, aes(x = time_point, y = count_adult, fill = location_name), size = 4, alpha = 0.5, pch = 21,
width = 2, height = 0) +
geom_vline(xintercept = "July21",
color = "red", linetype = "dashed", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~Species, nrow = 1, scales = "free") +
scale_y_continuous("Colonies in 30m2 transect", limits = c(0,20), expand = expansion(mult = c(0, 0.1))) +
#scale_x_discrete("", drop = FALSE, breaks = every_nth(n=4)) +
scale_x_discrete("", drop = FALSE, breaks = c('October19','January20', 'July21',
'May22','December22'),
expand = expansion(add = c(5, 5))) +
scale_fill_manual("Site",values=c(sitecolors)) +
theme(plot.title = element_text(size = 16,hjust = 0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text.x = element_text(colour = "black", hjust = 1, size = 10, angle = 45),
axis.title = element_text(size = 10),
legend.position = 'none',
plot.margin = unit(c(0.5, 0, 0.5, 0), "cm"))
tiff("Figures/hurd_lowdens.tif",width = 9, height = 4, units = "in", res = 400)
lowdensp
dev.off()
install.packages("performance")
install.packages("easystats")
install.packages("performance")
install.packages("performance")
library(performance)
zinbinom1 <- glmmTMB(count_adult ~ (1|location_name) + survey*Species,
data = dens,
ziformula = ~1,
family = nbinom1)
library(GLMMadaptive)
zinbinom1 <- glmmTMB(count_adult ~ (1|location_name) + survey*Species,
data = dens,
ziformula = ~1,
family = nbinom1)
library(glmmTMB)
zinbinom1 <- glmmTMB(count_adult ~ (1|location_name) + survey*Species,
data = dens,
ziformula = ~1,
family = nbinom1)
emm <- emmeans(zinbinom1, ~ survey*Species)
simple <- pairs(emm, simple = "survey")
simple <- pairs(emm, simple = "survey")
pairwise <- as.data.frame(pairs(emm, simple = "survey"))
df <- data.frame()
Spec <- levels(as.factor(pairwise$Species))
for(current_Spec in Spec) {
Spec_df <- pairwise %>% subset(Species == current_Spec)
pairwise$sig <- isSig(pairwise$p.value)
letters <- as.data.frame(cldList(p.value ~ contrast,
data = Spec_df,
threshold = 0.05)) %>%
mutate("Species" = current_Spec)
df <- df %>%
bind_rows(letters)
}
